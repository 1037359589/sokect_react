{"version":3,"sources":["jquery-control.js"],"names":[],"mappings":"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","file":"jquery-control-compiled.js","sourcesContent":["/**\n * Created by bll on 16/2/2.\n */\nvar $=require('jquery');\nvar socket = io.connect('/',{res:'id=123'});\n(function(jQuery,win,doc){\n    //\"use strict\";\n    var okRequest=['id','name'], //符合的参数\n        searchRequest,//请求参数字符串\n        $$,//node节点\n        chatLocal,//本地存贮\n        idAll=[],//所有Id\n        existId=['2'];\n    $$={\n        send:$(\"#send\"),\n        main:$(\"#main > .body\"),\n        messageText:$(\"#message-text\"),\n        gotClone:$('#got-clone'),\n        sentClone:$('#sent-clone'),\n        messageBody:$(\".message>.body\"),\n        empty:$(\"#empty\"),\n        addPerson:$(\"#add-person\"),\n        personModal:$(\"#person-modal\"),\n        cancel:$(\".cancel\")\n    };\n    //聊天框,初始化\n    function init(){\n        chatLocal= localStorage.getItem('chat');\n        var search=window.location.search;\n        searchRequest=getUrlRequest(search.substr(1));\n        var getId=getUserId();\n        if(!searchRequest||!isSetId()){\n            alert('id不存在或者参数不正确!!');\n            $('body').html(\"\");\n            return false;\n        }\n        showAllMessage();\n        //getExistId();\n    }\n    //function getExistId(){\n    //\n    //\n    //}\n    //function setExistId(){\n    //\n    //    localStorage.setItem('id',);\n    //\n    //}\n    //显示聊天的所有信息\n    function getAllMessage(){\n        var messageData=chatLocal.split(\";\");\n        var messageArr=[];\n        messageData.forEach(function(v,k){\n            var json = (new Function(\"return \" + v))();\n            messageArr.push(json);\n        });\n        return messageArr;\n    }\n    function showAllMessage(){\n        var message=getAllMessage();\n        var currentId=getUserId();\n        var html=\"\";\n        message.forEach(function(v,k){\n            var htm;\n            if(v==undefined)return;\n            if(v.id==currentId){\n                var sentClone=$$.sentClone.clone().removeClass(\"none\");\n                sentClone.find(\".text\").text(v.text);\n                htm=sentClone.prop(\"outerHTML\");\n            }else{\n                var gotClone=$$.gotClone.clone().removeClass(\"none\");\n                gotClone.find(\".text\").text(v.text);\n                gotClone.html();\n                htm=gotClone.prop(\"outerHTML\");\n            }\n            html+=htm;\n        });\n        $$.messageBody.append(html);\n    }\n    //判断是否存在该id\n    function isSetId(){\n        var chatArr=chatLocal.split(\";\");\n        var pass=false;\n        var isStr='\\\"id\\\"'+':\\\"'+getUserId()+'\\\"';\n        chatArr.forEach(function(v,k){\n            if(v.indexOf(isStr)>-1){\n                pass=true;\n            }\n        });\n        return pass;\n    }\n    //获取用户的id\n    function getUserId(){\n        var getId;\n        for(var k in searchRequest){\n            if(searchRequest[k].indexOf('id')>-1){\n                getId=searchRequest[k];\n                break;\n            }\n        }\n        return getId.split(\"=\")[1];\n    }\n    //更新localstorage\n    function updateLocalChat(id,text,time){\n        chatLocal= localStorage.getItem('chat');\n        var chat={id:id, text:text, time:time};\n        var chatStr=JSON.stringify(chat);\n        var getLocal=chatLocal==null?\"\":chatLocal;\n        chatStr=getLocal+chatStr+\";\";\n        localStorage.setItem('chat',chatStr);\n    }\n    //时间转化为时间戳\n    function timeToString(obj){\n        var year = obj.getFullYear(),//当前年份\n             month = obj.getMonth() + 1,//当前月份\n             day = obj.getDate(),//当前日\n             hour=obj.getHours(),       //获取当前小时数(0-23)\n             min=obj.getMinutes(),     //获取当前分钟数(0-59)\n             sec=obj.getSeconds();    //获取当前秒数(0-59)\n        return {\n            year:year,month:month,day:day,hour:hour,minute:min,second:sec\n        }\n    }\n    //获取合法参数\n    function getUrlRequest(search){\n        var splitStr=search.indexOf('&')>-1?'&':\" \";\n        var sea=search.split(splitStr);\n        var pass=true;\n        for(var k in sea){\n            var da=sea[k].split(\"=\");\n            pass=filterRequest(da[0]);\n            if(!pass)break;\n        }\n        if(!pass){alert('参数不对');$('body').html(\"\");return false;}\n        return sea;\n    }\n    //过滤参数\n    function filterRequest(ke){\n        var pass;\n        pass=$.inArray(ke, okRequest);\n        if(pass==-1){\n            return false;\n        }else{\n            return true;\n        }\n    }\n    //getUser();\n    socket.on('connect',function(){\n        init();\n        $$.send.on(\"click\",function(e){\n            var text=$$.messageText.text();\n            var getId;\n            if(text==\"\")return false;\n            var sentClone=$$.sentClone.clone().removeClass(\"none\");\n            sentClone.find(\".text\").text(text);\n            //发送信息\n            $$.messageBody.append(sentClone);\n            $$.messageText.text(\"\");\n            socket.send(text);\n            var myDate = new Date();\n            var timeObj=timeToString(myDate);\n            var time=timeObj.year+\"-\"+timeObj.month+\"-\"+timeObj.day+\" \"+timeObj.hour+\":\"+timeObj.minute+\":\"+timeObj.second;\n            //获取id\n            var id=getUserId();\n            updateLocalChat(id,text,time);\n        });\n        $$.addPerson.on(\"click\",function(){\n            $$.personModal.addClass('person-modal-active');\n        });\n        $$.cancel.on(\"click\",function(){\n            $$.personModal.removeClass('person-modal-active');\n        });\n    });\n    $(document).on(\"keyup\",function(event){\n        event.preventDefault();\n        if (event.keyCode == 13)\n        {\n            $$.send.trigger('click');\n        }else{\n            return false;\n        }\n    });\n    socket.on('message',function(data){\n        var gotClone=$$.gotClone.clone().removeClass(\"none\");\n        gotClone.find(\".text\").text(data);\n        $$.messageBody.append(gotClone);\n    });\n    $$.empty.on(\"click\",function(){\n        $$.main.html(\"\");\n    });\n})($,window.document);"]}